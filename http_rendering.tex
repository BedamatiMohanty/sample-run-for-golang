\documentclass[10pt,a4paper]{article}
\usepackage{fullpage}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{occi}
\setlength{\headheight}{13pt}
\pagestyle{fancy}

% default sans-serif
\renewcommand{\familydefault}{\sfdefault}

% no lines for headers and footers
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

% header
\fancyhf{}
\lhead{GWD-R}
\rhead{\today}

% footer
\lfoot{occi-wg@ogf.org}
\rfoot{\thepage}

% paragraphs need some space...
\setlength{\parindent}{0pt}
\setlength{\parskip}{1ex plus 0.5ex minus 0.2ex}

% some space between header and text...
\headsep 13pt

\setcounter{secnumdepth}{4}

\begin{document}

% header on first page is different
\thispagestyle{empty}

GWD-R \hfill Thijs Metsch, Platform Computing\\
OCCI-WG \hfill Andy Edmonds, Intel\\
\rightline {October 7, 2010}\\
\rightline {Updated: \today}

\vspace*{0.5in}

\begin{Large}
\textbf{Open Cloud Computing Interface - RESTful HTTP Rendering}
\end{Large}

\vspace*{0.5in}

\underline{Status of this Document}

This document provides information to the community regarding the
specification of the Open Cloud Computing Interface. Distribution is
unlimited.

\underline{Copyright Notice}

Copyright \copyright Open Grid Forum (2009-2010). All Rights Reserved.

\underline{Trademarks}

OCCI is a trademark of the Open Grid Forum.

\underline{Abstract}

This document, part of a document series, produced by the OCCI working
group within the Open Grid Forum (OGF), provides a high-level
definition of a Protocol and API. The document is based upon
previously gathered requirements and focuses on the scope of important
capabilities required to support modern service offerings.

\newpage
\tableofcontents
\newpage

\section{Introduction}
\input{include/introduction}

\section{Notational Conventions}
\input{include/notational}

All examples in this document use one of the following three
Categories. An example name-space is also given. Syntax and Semantics
is explained in the remaining sections of the document. These examples
do not strive to be complete but to show the functionalities OCCI has:

\begin{verbatim}

Category:compute;scheme=http://schemas.ogf.org/occi/infrastructure;location=/compute 
                                                           (This is an compute kind)
Category:storage;scheme=http://schemas.ogf.org/occi/infrastructure;location=/storage 
                                                           (This is an storage kind)
Category:my_stuff;scheme=http://example.com/occi/my_stuff;location=/my_stuff 
                                                           (This is a mixin of user1)

The following namespace hierarchy is used in the examples:

http://example.com/-/
http://example.com/vms/user1/vm1
http://example.com/vms/user1/vm2
http://example.com/vms/user2/vm1
http://example.com/disks/user1/disk1
http://example.com/disks/user2/disk1
http://example.com/compute/
http://example.com/storage/
http://example.com/my_stuff/
\end{verbatim}

\section{A RESTful HTTP rendering for OCCI compliant Interfaces}
The HTTP Protocol is the underlying core fabric of OCCI and uses all
the features of the HTTP and underlying protocols (like self-healing
capabilities of TCP) offer. OCCI also builds upon the Resource
Oriented Architecture (ROA). ROA's use Representation State Transfer
(REST) to cater for client and service interactions. Interaction with
the system is by inspection and modification of a set of related
resources and their states, be it on the complete state or a
sub-set. Resources must be uniquely identified. HTTP is an ideal
protocol to use in ROA systems as it provides the means to uniquely
identify individual resources through URLs as well as operating upon
them with a set of general-purpose HTTP verbs. These HTTP verbs map
loosely to the resource related operations of Create (POST), Retrieve
(GET), Update (POST/PUT) and Delete (DELETE).

The following notations are used when referring to parts or complete
URIs:

\begin{verbatim}
http://www.example.com:8080/foo/bar;action=stop
<   >  <     Authority    >< Path >< Fragment >
  ^
  Scheme
\end{verbatim}

The following section describe the general behavior for all HTTP based
renderings. Later sections will describe the syntax and semantic of
how to render the OCCI Core model with different Content-Types.

Each Kind sub-type instance within an OCCI system must be uniquely
identified by an URI. The structure of these URIs is opaque and the
system should not assume a static, pre-determined scheme for their
structure (Example: \emph{http://example.com/vms/user1/vm1}).

\subsection{Behavior of the HTTP Verbs}
As OCCI adopts a ROA, REST-based architecture and uses HTTP as the
foundation protocol the means of interaction with all RESTful resource
instances is through the four main HTTP verbs. OCCI service
implementations must, at a minimum, support these verbs:

\textbf{TODO: add table}

\subsection{A RESTful rendering of OCCI}
The following sections and paragraphs described how the OCCI model
MUST be implemented by service providers. Operations which are not
defined are out of scope for this specification and MAY be implemented
by the service provider. This is just a minimal set to ensure
interoperability.

\subsubsection{Name-space Hierarchy and locations}
The name-space and the hierarchy are free definable by the Service
Provider. Although the Service Provider MUST implement the location
path feature which is required by OCCI for discovery capabilities and
operations on \hl{Mixin}s and \hl{Kind}s. Location paths tell the
client where all resource instance of one \hl{Kind} or \hl{Mixin} can
be found regardless of the hierarchy the service provider
defines. These paths are discoverable by the client through the Query
interface.

These location paths can be part of the name-space or rendered
alongside. The following example shows how the locations paths are
rendered alongside the name-space hierarchy:

\begin{verbatim}
Category:compute;scheme=http://schemas.ogf.org/occi/infrastructure;location=/compute 
                                                           (This is an compute kind)
Category:storage;scheme=http://schemas.ogf.org/occi/infrastructure;location=/storage 
                                                           (This is an storage kind)
Category:my_stuff;scheme=http://example.com/occi/my_stuff;location=/my_stuff 
                                                           (This is a mixin of user1)

The following namespace hierarchy is used in the examples:

http://example.com/-/
http://example.com/vms/user1/vm1
http://example.com/vms/user1/vm2
http://example.com/vms/user2/vm1
http://example.com/disks/user1/disk1
http://example.com/disks/user2/disk1
http://example.com/compute/
http://example.com/storage/
http://example.com/my_stuff/
\end{verbatim}

Location paths can also be part of the name-space
hierarchy:\footnote{/vms/user1/vm1 (= OCCI base type ID) is a resource
  instance below the name-space path /vms/user1/.}

\begin{verbatim}
Category:compute;scheme=http://schemas.ogf.org/occi/infrastructure;location=/vms 
                                                           (This is an compute kind)
Category:storage;scheme=http://schemas.ogf.org/occi/infrastructure;location=/disks 
                                                           (This is an storage kind)
Category:my_stuff;scheme=http://example.com/occi/my_stuff;location=/my_stuff 
                                                           (This is a mixin of user1)

The following namespace hierarchy is used in the examples:

http://example.com/-/
http://example.com/vms/user1/vm1
http://example.com/vms/user1/vm2
http://example.com/vms/user2/vm1
http://example.com/disks/user1/disk1
http://example.com/disks/user2/disk1
http://example.com/my_stuff/
\end{verbatim}

\subsubsection{Various Operations and their prerequisites and behaviors}

\paragraph{Operations on resource instances}
The following operations MUST be implemented by the service provider
for operations of resource instances. The resource instance is
uniquily identified by an URI (For example:
\emph{http://example.com/vms/user1/vm1} - Note: the path MUST not end
with an '/').

\begin{description}
\item[Creating a resource instance] A request to create a resource
  instance MUST contain at least one Category definition which is (or
  relates to) a \hl{Kind} definition. If multiple Categories are
  defined the first one which is (or relates to) to a \hl{Kind} MUST
  be used for defining the type of the resource instance. Optional
  information which might be provided by the client and if available
  MUST be used are Links and Attributes. Two ways can be used to
  create a new resource instance - HTTP POST or PUT:
\begin{verbatim}
> POST / HTTP/1.1
> [...]
> 
> Category:compute;scheme=http://schemas.ogf.org/occi/infrastructure
> X-OCCI-Attribute:occi.compute.cores=2 occi.compute.hostname=foobar
> [...]
 
< HTTP/1.1 200 OK
< [...]
< Location:http://example.com/vms/user1/vm1
\end{verbatim}
  The path on which this POST verb is executed can be any existing
  path in the hierachy of the service providers name-space. The
  service must return the Location of the newly created resource
  instance.

  Or HTTP PUT can be used. In this case the client ask the service
  provider to create a resource instance at a certain path in the
  namespace hierarchy.\footnote{If a Service Provider does not want the
    user to define the path of a resource instance it can return a Bad
    Request return code - See section \ref{sec:return_codes}.}
\begin{verbatim}
> PUT /vms/user1/my_first_virtual_machine HTTP/1.1
> [...]
> 
> Category:compute;scheme=http://schemas.ogf.org/occi/infrastructure
> X-OCCI-Attribute:occi.compute.cores=2 occi.compute.hostname=foobar
> [...]
 
< HTTP/1.1 200 OK
< [...]
\end{verbatim}
  The service will return an OK code.

\item[Retrieving a resource instance] For retrieval the HTTP GET verb
  is used. It MUST return at least the Category which defines the
  \hl{Kind} of the resource instance. Links pointing to references
  resource instances, other URI or Actions (This SHOULD only be the
  \hl{Actions} which are currently applicable) MUST be included if
  present. The Attributes of the resource instance MUST be exposed to
  the client if available.
\begin{verbatim}
> GET /vms/user1/vm1 HTTP/1.1
> [...]
 
< HTTP/1.1 200 OK
< [...]
< Category:compute;scheme=http://schemas.ogf.org/occi/infrastructure
< Category:my_stuff;scheme=http://example.com/occi/my_stuff
< X-OCCI-Attribute:occi.compute.cores=2 occi.compute.hostname=foobar
< Link: [...]
\end{verbatim}

\item[Updating a resource instance] Before updating a resource
  instance it is RECOMMENDED that the client first retrieves the
  resource instance. Updating is done using the HTTP PUT verb. Only
  the information (Links, Attributes or \hl{Mixin} Categories) which
  is updated MUST be provided along with the
  request.\footnote{Changing the type of the resource instance MUST
    not be possible.}
\begin{verbatim}
> PUT /vms/user1/vm1 HTTP/1.1
> [...]
> 
> X-OCCI-Attribute:occi.compute.memory=4G
> [...]
 
< HTTP/1.1 200 OK
< [...]
\end{verbatim}

\item[Deleting a resource instance] A resource instance can be deleted
  using the HTTP DELETE verb. No other information SHOULD be added to
  the request
\begin{verbatim}
> DELETE /vms/user1/vm1 HTTP/1.1
> [...]

< HTTP/1.1 200 OK
< [...]
\end{verbatim}

\item[Triggering an action on a resource instance] To trigger an
  action on a resource instance the request MUST containg the Category
  defining the \hl{Action}. It MAY include attributes which are the
  parameters of the action. Actions are triggered using the HTTP POST
  verb and by adding a fragment to the url. This fragment exposes the
  term of the \hl{Action}. If an action is not available or a proper
  return code should be returned.
\begin{verbatim}
> POST /vms/user1/vm1;action=stop HTTP/1.1
> [...]
> X-OCCI-Attribute:flag=poweroff

< HTTP/1.1 200 OK
< [...]
\end{verbatim}
\end{description}

\paragraph{Handling the Query interface}

- retireinvg all registered catgories

Filtering through cat def!

- removing a mixin definition

- adding a mixin definition

\paragraph{Operations on \hl{Mixin}s or \hl{Kind}s}

Defined by location path....

- Retrieving all instances of a mixin or kind

Filtering through cat def!

- triggering actions on all instaces of an mixin or kind (action must be defined by mixin!)

- adding a resource to a mixin

- removing a resource instance from a mixin

\paragraph{Operation on paths in the namespace}

Must end with /

- Retrieval

Filtering through cat def!

- Deleteing all resource instance below this namespace

\subsection{Syntax and semantics of the rendering}

 Category
 Link
 X-OCCI-Attribute
 X-OCCI-Location

\subsection{General HTTP behaviour which is adopted by OCCI}

- Content types

- Versioning

- Auth.

- Autho.

\subsubsection{Return codes}
\label{sec:return_codes}

Bad Request...

%\subsection{Security and Authentication}
%OCCI does not require that an authentication mechanism be used nor
%does it require that client to service communications are secured. It
%does recommend that an authentication mechanism be used and that where
%appropriate, communications are encrypted using HTTP over TLS. The
%authentication mechanisms that CAN be used with OCCI are those that
%can be used with HTTP and TLS, for example Basic [REF], Digest [REF]
%and OAuth [REF]. If an OCCI service requires authentication the
%response to a request that MUST be authenticated must be a HTTP 401
%code that indicates the request is authorized. In response to
%authenticate the client MUST set a WWW-Authenticate header field and
%through this indicate the authentication mechanism.
%
%\subsection{Versioning}
%Information about what version of OCCI is supported by a provider MUST
%be advertised to a client on each response to a client. The version
%field in the response MUST include the value OCCI/X.Y, where X is the
%major version number and Y is the minor version number of the
%implemented OCCI specification. In the case of a HTTP Header
%Rendering, the server response should relay versioning information
%using the HTTP header name 'Server'.
%
%\begin{verbatim}
%HTTP/1.1 202 Accepted
%Server: occi-server/1.1 (linux) OCCI/1.0
%[...]
%\end{verbatim}
%
%Complimenting the service-side behavior of an OCCI implementation, a
%client MUST indicate to the OCCI service implementation the version it
%expects to interact with. For the clients, the information MUST be
%advertised in the request it issues. In the case of a HTTP Header
%Rendering, the client request should relay versioning information in
%the 'User-Agent' header. The 'User-Agent' field must include the same
%value (OCCI/X.Y) as specified for the Server HTTP header.
%
%\begin{verbatim}
%GET <UDN> HTTP/1.1
%Host: example.com
%User-Agent: occi-client/1.1 (linux) libcurl/7.19.4 OCCI/1.0
%[...]
%\end{verbatim}
%
%If a server receives a request from a client that supplies a version
%number higher than the service supports, the service MUST respond back
%to the client with an exception indicating that the requested version
%is not implemented. Where a client implements OCCI using a HTTP
%transport, the HTTP code 501, not implemented should be used.
%
%\subsection{Content-type and Accept headers}
%A server MUST react according to the Accept header the client
%provides. If non is given - or \textit{*/*} is used - the service MUST
%use the HTTP Body Rendering described in section
%\ref{sec:http_body}. This is the fall-back rendering and MUST be
%implemented. Otherwise the according rendering MUST be used. Each
%Rendering SHOULD expose which Accept and Content-type header fields it
%can handle. Overall the server MUST support the \textit{text/occi},
%\textit{text/plain} and \textit{text/uri-list} Content-types.
%
%The server MUST also return the proper Content-type header. If a
%client POSTs information with a Content-Type - the information MUST be
%parsed accordingly.
%
%When the Client request a Content-Type will will result in an
%incomplete or faulty rendering the Service MUST return the 406 Not
%Acceptable HTTP code.
%
%\subsection{Discovery and Listing}
%When performing an GET operation an server MUST reply with a listing
%of matching Kinds. If the request was preformed on a Path of an URI
%only the sub-resource SHOULD be returned. If a Category was given in
%the request the server MUST only give back Kinds which have this
%Category assigned.
%
%If the request was performed on the \textit{/-/} Path a list of
%Categories which the server can handle MUST be returned. Categories
%used for tagging are not exported via this mechanism.
%
%Each category MUST have an unique location assigned which COULD be the
%term of the category. This path MUST NOT be empty. At a minimum it
%could be \textit{'/'} It reflects the path under which REST-resources
%which relate to this category can be found. Adding and removing
%REST-Resources from a category is done by operating on this
%path\footnote{The path MUST end with /}.
%
%\subsection{Behavior of HTTP operations}
%
%More information on how OCCI compatible Service should handle the HTTP
%verbs is given in these sections. Possible results are demonstrated
%here. How to render the results is described later on.
%
%\subsubsection{Return Codes}
%The following return codes CAN be returned by an Service implementing
%OCCI.
%
%\subsection{Rendering the OCCI model}
%\label{sec:model_rendering}
%The following subsection demonstrate how the OCCI base types can be
%syntactically rendered.
%
%\marginpar{User proper ABNF grammar to describe the header formats.}
%
%\subsubsection{Rendering of an OCCI-Category}
%
%The semantics of the Category in the OCCI context is described in the
%OCCI Core \& Models document.\footnote{This rendering follows the
%  Category header defined by the Web Categories specification,
%  http://tools.ietf.org/html/draft-johnston-http-category-header-01
%  and MUST be rendered accordingly.}
%
%\marginpar{Define ``Categary identifier'' somewhere,
%  i.e. concatenation of scheme + term.}
%
%\begin{verbatim}
%Category: <term>; scheme="<scheme>"
%    [;rel=<space-separated list of related Category identifiers>]
%    [;attributes=<space-seperated list of attribute names>]
%    [;title=<Title of this Category>]    
%    ;location=<Parent location>
%\end{verbatim}
%
%There is NO order for the optional part.
%
%\subsubsection{Rendering of OCCI-Links and OCCI-Actions}
%The semantics of the Link header in the OCCI context is described in
%the OCCI Core \& Models document.\footnote{This rendering follows the
%  Link header defined by the Web Linking specification,
%  http://tools.ietf.org/html/draft-nottingham-http-link-header-10 and
%  MUST be rendered accordingly.}
%
%\begin{verbatim}
%Link: <Resource URL>;
%    rel=<space-separated list of Category identifiers of the target Resource type>
%    [;self=<Link instance URL>]
%    [;category=<space-separated list of Category identifiers of the Link type>
%    [;<attribute name>=<attribute value>] ... ]
%
%or in case it is an Action:
%
%Link: <Resource URL> + ";action=" + <Term of the Action>;
%    rel=<Category identifier of the Action>
%\end{verbatim}
%
%\subsubsection{Rendering of OCCI-Attributes}
%The X-OCCI-Attribute MUST be used to render the attributes associated
%with a OCCI Kind. A simple key-value format is used. The field value
%consist of an attribute name followed by an equal sign ("=") and the
%attribute value. The attribute value must be quoted if it includes a
%separator character, see RFC 2616 (page 16).
%
%\begin{verbatim}
%X-OCCI-Attribute: <attribute name>=<attribute value>
%\end{verbatim}
%
%Valid attribute names for OCCI Kinds are specified in appropriate
%Extension documents.
%
%\subsubsection{Rendering of Location-URLs}
%To render an OCCI representation solely in the header, the
%X-OCCI-Location header MUST be used to return a list of Kind
%URLs. Each header field value correspond to a single URL. Multiple
%Kind URLs are returned using multiple X-OCCI-Location headers. See RFC
%2616 for information on how to render multiple HTTP headers.
%
%\begin{verbatim}
%X-OCCI-Location: <URL>
%\end{verbatim}
%
%\subsubsection{Fields}
%The following setups show how the Core Model MUST be rendered. Shown
%are the fields which MUST be available in a request from the Client or
%a response from the Server.
%
%\begin{tabular}{l|l|l|l}
%Operation & Required HTTP-Header(s) & Optional HTTP-Header(s) & Notes \\
%\hline
%Rendering of a Category & Category & N/A & \\
%Rendering a list of Categories & Category & N/A & \\
%Rendering a list of Kinds & X-OCCI-Location & N/A & \\
%Rendering of a Resource & Category & X-OCCI-Attribute, Link & \\
%Rendering of an Action & Category, Link & X-OCCI-Attribute & \\
%Rendering of a Link & Category, Link & X-OCCI-Attribute & \\
%\end{tabular}
%
%\subsubsection{Rendering the OCCI model in the HTTP Body}
%\label{sec:http_body}
%While using this rendering with the Content-Type \textit{text/plain}
%the information described in section \ref{sec:model_rendering} MUST be
%placed in the HTTP Body.
%
%Each Rendering of an OCCI base type will be placed in the body. Each
%entry consists of a name followed by a colon (":") and the field
%value. The format of the field value is specified separately for each
%of the three header fields, see section \ref{sec:model_rendering}.
%
%\subsubsection{Rendering the OCCI model in the HTTP Header}
%While using this rendering with the Content-Type \textit{text/occi}
%the information described in section \ref{sec:model_rendering} MUST be
%placed in the HTTP Header. The body MUST contain the string 'OK' on
%successfull operations.
%
%The HTTP header fields MUST follow the specification in RFC 2616
%\cite{rfc2616}. A header field consists of a name followed by a colon
%(":") and the field value. The format of the field value is specified
%separately for each of the three header fields, see section
%\ref{sec:model_rendering}.
%
%\paragraph{Limitations}
%HTTP header fields MAY appear multiple times in a HTTP request or
%response. In order to be OCCI compliant the specification of multiple
%message-header fields according to RFC 2616 MUST be fully
%supported. In essence there are two valid representation of multiple
%HTTP header field values. A header field might either appear several
%times or as a single header field with a comma-separated list of field
%values. Due to implementation issues in many web frameworks and client
%libraries it is RECOMMENDED to use the comma-separated list format for
%best interoperability.
%
%HTTP header field values which contain separator characters MUST be
%properly quoted according to RFC 2616.
%
%Space in the HTTP header section of a HTTP request is a limited
%resource. By this, it is noted that many HTTP servers limit the number
%of bytes that can be placed in the HTTP Header area. Implementers MUST
%be aware of this limitation in their own implementation and take
%appropriate measures so that truncation of header data does NOT
%occure.
%
%\subsubsection{Rendering the OCCI model via URL Listings}
%
%\textbf{This Rendering can handle the \textit{text/uri-list} Accept
%  Header. It will \textit{text/uri-list} an empty Content-type}
%
%This rendering cannot render Kinds or Categories directly but just
%Links to them. For concrete rendering of Kinds and Categories the
%Content-types \textit{text/occi}, \textit{text/plain} MUST be used. If
%a request is done with the \textit{text/uri-list} in the Accept
%header, while not requesting for a Listing a Bad Request MUST be
%returned.
%
%\paragraph{Rendering a list of Categories}
%
%MUST return a list of Category scheme URLs.
%
%\paragraph{Rendering a list of Kinds}
%
%MUST return a list of URLs pointing to the Kinds.

\section{Contributors}

Editors: Andy Edmonds, Thijs Metsch \\
Contributors: Alexander Papaspyrou, Ralf Nyrén, Sam Johnston

\textbf{TBD: Bunch op people missing here - create table\ldots}

\section{Glossary}
\label{sec:glossary}
\input{include/glossary}

\section{Intellectual Property Statement}
\input{include/ip}

\section{Disclaimer}
\input{include/disclaimer}

\section{Full Copyright Notice}
\input{include/copyright}

\section{References}

\bibliographystyle{IEEEtran}
\bibliography{references}

\end{document}
